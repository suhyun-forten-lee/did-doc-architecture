<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1914px" preserveAspectRatio="none" style="width:1376px;height:1914px;background:#FFFFFF;" version="1.1" viewBox="0 0 1376 1914" width="1376px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="25" font-weight="bold" lengthAdjust="spacing" textLength="286" x="541" y="39.1699">Server Token Creation</text><rect fill="#FFFFFF" height="321.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="92" y="275.2832"/><rect fill="#FFFFFF" height="1740.4277" style="stroke:#181818;stroke-width:1.0;" width="10" x="399" y="113.4199"/><rect fill="#FFFFFF" height="263.416" style="stroke:#181818;stroke-width:1.0;" width="10" x="689" y="684.252"/><rect fill="#FFFFFF" height="485.832" style="stroke:#181818;stroke-width:1.0;" width="10" x="968" y="1136.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="96.5" x2="96.5" y1="103.4199" y2="1862.8477"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="404" x2="404" y1="103.4199" y2="1862.8477"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="693.5" x2="693.5" y1="103.4199" y2="1862.8477"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="972.5" x2="972.5" y1="103.4199" y2="1862.8477"/><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="62.5" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="69.5" y="75.9785">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="74.5" y="92.4668">Wallet</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="62.5" y="1861.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="69.5" y="1882.3828">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="74.5" y="1898.8711">Wallet</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="349" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="383" y="75.9785">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="96" x="356" y="92.4668">Certified App</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="349" y="1861.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="383" y="1882.3828">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="96" x="356" y="1898.8711">Certified App</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="611.5" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="665.5" y="75.9785">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="151" x="618.5" y="92.4668">Certified App Service</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="611.5" y="1861.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="665.5" y="1882.3828">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="151" x="618.5" y="1898.8711">Certified App Service</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="937.5" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="944.5" y="75.9785">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="20" x="963" y="92.4668">TA</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="937.5" y="1861.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="944.5" y="1882.3828">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="20" x="963" y="1898.8711">TA</text><rect fill="#FFFFFF" height="321.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="92" y="275.2832"/><rect fill="#FFFFFF" height="1740.4277" style="stroke:#181818;stroke-width:1.0;" width="10" x="399" y="113.4199"/><rect fill="#FFFFFF" height="263.416" style="stroke:#181818;stroke-width:1.0;" width="10" x="689" y="684.252"/><rect fill="#FFFFFF" height="485.832" style="stroke:#181818;stroke-width:1.0;" width="10" x="968" y="1136.5313"/><rect fill="#FEFFDD" height="53" style="stroke:#181818;stroke-width:0.5;" width="184" x="5" y="118.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="9" y="134.9883">[Pre-defined]</text><ellipse cx="14.5" cy="145.541" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="21" y="150.2988">WALLET_ID = Wallet ID</text><ellipse cx="14.5" cy="160.8516" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="21" y="165.6094">WALLET_DID = Wallet DID</text><rect fill="#FEFFDD" height="53" style="stroke:#181818;stroke-width:0.5;" width="329" x="239" y="118.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="243" y="134.9883">[Pre-defined]</text><ellipse cx="248.5" cy="145.541" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="255" y="150.2988">APP_ID = CApp ID</text><ellipse cx="248.5" cy="160.8516" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="255" y="165.6094">sesKey, padding = Generated with TAS and ECDH</text><rect fill="#FEFFDD" height="38" style="stroke:#181818;stroke-width:0.5;" width="339" x="803" y="118.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="807" y="134.9883">[Pre-defined]</text><ellipse cx="812.5" cy="145.541" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319" x="819" y="150.2988">sesKey, padding = Generated with CApp and ECDH</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1369" x="0" y="198.0068"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="198.0068" y2="198.0068"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="201.0068" y2="201.0068"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="147" x="611" y="187.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129" x="617" y="203.9199">1. SignedWalletInfo</text><polygon fill="#32CD32" points="51,225.6621,740,225.6621,750,236.6621,740,248.6621,51,248.6621,41,236.6621,51,225.6621" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="280" cy="237.4727" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="286.5" y="242.2305">walletToken = Generate wallet token</text><polygon fill="#181818" points="113,271.2832,103,275.2832,113,279.2832,109,275.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="107" x2="398" y1="275.2832" y2="275.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="119" y="270.541">(1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="142" y="270.541">Request Signed Wallet Info {walletToken}</text><line style="stroke:#181818;stroke-width:1.0;" x1="102" x2="144" y1="350.5254" y2="350.5254"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="144" y1="350.5254" y2="363.5254"/><line style="stroke:#181818;stroke-width:1.0;" x1="103" x2="144" y1="363.5254" y2="363.5254"/><polygon fill="#181818" points="113,359.5254,103,363.5254,113,367.5254,109,363.5254" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="109" y="322.8174">(2)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="132" y="299.8516">Prepare Data</text><ellipse cx="137.5" cy="310.4043" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="144" y="315.1621">id = WALLET_ID</text><ellipse cx="137.5" cy="325.7148" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="144" y="330.4727">did = WALLET_DID</text><ellipse cx="137.5" cy="341.0254" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="144" y="345.7832">wallet = {id, did}</text><line style="stroke:#181818;stroke-width:1.0;" x1="102" x2="144" y1="423.457" y2="423.457"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="144" y1="423.457" y2="436.457"/><line style="stroke:#181818;stroke-width:1.0;" x1="103" x2="144" y1="436.457" y2="436.457"/><polygon fill="#181818" points="113,432.457,103,436.457,113,440.457,109,436.457" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="109" y="403.4043">(3)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="132" y="388.0938">Generate Wallet Info</text><ellipse cx="137.5" cy="398.6465" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="144" y="403.4043">nonce = Generate random number</text><ellipse cx="137.5" cy="413.957" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="144" y="418.7148">dataset = {wallet, nonce}</text><line style="stroke:#181818;stroke-width:1.0;" x1="102" x2="144" y1="496.3887" y2="496.3887"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="144" y1="496.3887" y2="509.3887"/><line style="stroke:#181818;stroke-width:1.0;" x1="103" x2="144" y1="509.3887" y2="509.3887"/><polygon fill="#181818" points="113,505.3887,103,509.3887,113,513.3887,109,509.3887" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="109" y="476.3359">(4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="132" y="461.0254">Sign Wallet</text><ellipse cx="137.5" cy="471.5781" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="144" y="476.3359">priKey = Assertion private key</text><ellipse cx="137.5" cy="486.8887" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="144" y="491.6465">proof = signAssert(dataset, priKey)</text><line style="stroke:#181818;stroke-width:1.0;" x1="102" x2="144" y1="554.0098" y2="554.0098"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="144" y1="554.0098" y2="567.0098"/><line style="stroke:#181818;stroke-width:1.0;" x1="103" x2="144" y1="567.0098" y2="567.0098"/><polygon fill="#181818" points="113,563.0098,103,567.0098,113,571.0098,109,567.0098" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="109" y="541.6123">(5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="132" y="533.957">(SignedWalletInfo)swi</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="136" y="549.2676">= {wallet, nonce, proof}</text><polygon fill="#181818" points="387,592.3203,397,596.3203,387,600.3203,391,596.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="97" x2="393" y1="596.3203" y2="596.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="104" y="591.5781">(6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="127" y="591.5781">{swi}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1369" x="0" y="624.9756"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="624.9756" y2="624.9756"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="627.9756" y2="627.9756"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="145" x="612" y="614.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="127" x="618" y="630.8887">2. AttestedAppInfo</text><polygon fill="#181818" points="677,680.252,687,684.252,677,688.252,681,684.252" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="409" x2="683" y1="684.252" y2="684.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="416" y="671.8545">(7)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="439" y="664.1992">Request Signed App Info</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="439" y="679.5098">{APP_ID}</text><line style="stroke:#181818;stroke-width:1.0;" x1="699" x2="741" y1="774.8047" y2="774.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="741" x2="741" y1="774.8047" y2="787.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="700" x2="741" y1="787.8047" y2="787.8047"/><polygon fill="#181818" points="710,783.8047,700,787.8047,710,791.8047,706,787.8047" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="706" y="739.4414">(8)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="729" y="708.8203">Prepare Data</text><ellipse cx="734.5" cy="719.373" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="741" y="724.1309">appId = APP_ID</text><ellipse cx="734.5" cy="734.6836" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="741" y="739.4414">provider = Provider Information</text><ellipse cx="734.5" cy="749.9941" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="741" y="754.752">nonce = Generate random number</text><ellipse cx="734.5" cy="765.3047" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="741" y="770.0625">dataset = {appId, provider, nonce}</text><line style="stroke:#181818;stroke-width:1.0;" x1="699" x2="741" y1="847.7363" y2="847.7363"/><line style="stroke:#181818;stroke-width:1.0;" x1="741" x2="741" y1="847.7363" y2="860.7363"/><line style="stroke:#181818;stroke-width:1.0;" x1="700" x2="741" y1="860.7363" y2="860.7363"/><polygon fill="#181818" points="710,856.7363,700,860.7363,710,864.7363,706,860.7363" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="706" y="827.6836">(9)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="729" y="812.373">CApp Provider Signature</text><ellipse cx="734.5" cy="822.9258" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="741" y="827.6836">priKey = Attestation private key</text><ellipse cx="734.5" cy="838.2363" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="741" y="842.9941">proof = signAssert(dataset, priKey)</text><line style="stroke:#181818;stroke-width:1.0;" x1="699" x2="741" y1="905.3574" y2="905.3574"/><line style="stroke:#181818;stroke-width:1.0;" x1="741" x2="741" y1="905.3574" y2="918.3574"/><line style="stroke:#181818;stroke-width:1.0;" x1="700" x2="741" y1="918.3574" y2="918.3574"/><polygon fill="#181818" points="710,914.3574,700,918.3574,710,922.3574,706,918.3574" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="706" y="892.96">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="738" y="885.3047">(AttestedAppInfo)aai</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="742" y="900.6152">= {appId, provider, nonce, proof}</text><polygon fill="#181818" points="420,943.668,410,947.668,420,951.668,416,947.668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="414" x2="693" y1="947.668" y2="947.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="426" y="942.9258">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="458" y="942.9258">{aai}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1369" x="0" y="976.3232"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="976.3232" y2="976.3232"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="979.3232" y2="979.3232"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="151" x="609" y="965.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133" x="615" y="982.2363">3. ServerTokenSeed</text><line style="stroke:#181818;stroke-width:1.0;" x1="409" x2="451" y1="1050.9102" y2="1050.9102"/><line style="stroke:#181818;stroke-width:1.0;" x1="451" x2="451" y1="1050.9102" y2="1063.9102"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="451" y1="1063.9102" y2="1063.9102"/><polygon fill="#181818" points="420,1059.9102,410,1063.9102,420,1067.9102,416,1063.9102" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="416" y="1030.8574">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="448" y="1015.5469">Generate Token Seed</text><ellipse cx="453.5" cy="1026.0996" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="460" y="1030.8574">(ServerTokenSeed)seed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="452" y="1046.168">= {purpose, swi, aai}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1369" x="0" y="1092.5654"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="1092.5654" y2="1092.5654"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="1095.5654" y2="1095.5654"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="150" x="609.5" y="1081.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132" x="615.5" y="1098.4785">4. ServerTokenData</text><polygon fill="#181818" points="956,1132.5313,966,1136.5313,956,1140.5313,960,1136.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="409" x2="962" y1="1136.5313" y2="1136.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="416" y="1131.7891">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="448" y="1131.7891">Request Server Token Creation {seed}</text><line style="stroke:#181818;stroke-width:1.0;" x1="978" x2="1020" y1="1211.7734" y2="1211.7734"/><line style="stroke:#181818;stroke-width:1.0;" x1="1020" x2="1020" y1="1211.7734" y2="1224.7734"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="1020" y1="1224.7734" y2="1224.7734"/><polygon fill="#181818" points="989,1220.7734,979,1224.7734,989,1228.7734,985,1224.7734" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="985" y="1184.0654">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="1017" y="1161.0996">Verify Signature</text><ellipse cx="1022.5" cy="1171.6523" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="1029" y="1176.4102">Validate seed.swi.verification</text><ellipse cx="1022.5" cy="1186.9629" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328" x="1029" y="1191.7207">(Optional) Verify Provider Membership Certificate VC</text><ellipse cx="1022.5" cy="1202.2734" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="1029" y="1207.0313">Validate seed.aai.verification</text><line style="stroke:#181818;stroke-width:1.0;" x1="978" x2="1020" y1="1361.2578" y2="1361.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1020" x2="1020" y1="1361.2578" y2="1374.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="1020" y1="1374.2578" y2="1374.2578"/><polygon fill="#181818" points="989,1370.2578,979,1374.2578,989,1378.2578,985,1374.2578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="985" y="1302.9287">(15)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="1017" y="1249.3418">(ServerTokenData)std = {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="1033" y="1264.6523">purpose = seed.purpose,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="1033" y="1279.9629">walletId = seed.swi.wallet.id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="1033" y="1295.2734">caAppId = seed.aai.appId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="1033" y="1310.584">validUntil = Expiry Date,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="1033" y="1325.8945">provider = Provider Information,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="1033" y="1341.2051">nonce = Generate random number</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1025" y="1356.5156">}</text><line style="stroke:#181818;stroke-width:1.0;" x1="978" x2="1020" y1="1434.1895" y2="1434.1895"/><line style="stroke:#181818;stroke-width:1.0;" x1="1020" x2="1020" y1="1434.1895" y2="1447.1895"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="1020" y1="1447.1895" y2="1447.1895"/><polygon fill="#181818" points="989,1443.1895,979,1447.1895,989,1451.1895,985,1447.1895" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="985" y="1414.1367">(16)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="1017" y="1398.8262">Provider Signature</text><ellipse cx="1022.5" cy="1409.3789" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="1029" y="1414.1367">priKey = Attestation private key</text><ellipse cx="1022.5" cy="1424.6895" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="1029" y="1429.4473">proof = signAssert(std, priKey)</text><line style="stroke:#181818;stroke-width:1.0;" x1="978" x2="1020" y1="1491.8105" y2="1491.8105"/><line style="stroke:#181818;stroke-width:1.0;" x1="1020" x2="1020" y1="1491.8105" y2="1504.8105"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="1020" y1="1504.8105" y2="1504.8105"/><polygon fill="#181818" points="989,1500.8105,979,1504.8105,989,1508.8105,985,1504.8105" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="985" y="1479.4131">(17)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1017" y="1471.7578">Generate Server Token</text><ellipse cx="1022.5" cy="1482.3105" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1029" y="1487.0684">serverToken = sha256(std)</text><line style="stroke:#181818;stroke-width:1.0;" x1="978" x2="1020" y1="1580.0527" y2="1580.0527"/><line style="stroke:#181818;stroke-width:1.0;" x1="1020" x2="1020" y1="1580.0527" y2="1593.0527"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="1020" y1="1593.0527" y2="1593.0527"/><polygon fill="#181818" points="989,1589.0527,979,1593.0527,989,1597.0527,985,1593.0527" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="985" y="1552.3447">(18)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="1017" y="1529.3789">Encrypt Response Data</text><ellipse cx="1022.5" cy="1539.9316" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="1029" y="1544.6895">iv = Generate IV</text><ellipse cx="1022.5" cy="1555.2422" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="1029" y="1560">tmp = enc(std, sesKey, iv, padding)</text><ellipse cx="1022.5" cy="1570.5527" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="1029" y="1575.3105">encStd = multibase(tmp)</text><polygon fill="#181818" points="420,1618.3633,410,1622.3633,420,1626.3633,416,1622.3633" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="414" x2="972" y1="1622.3633" y2="1622.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="426" y="1617.6211">(19)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="458" y="1617.6211">{iv, encStd}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1369" x="0" y="1651.0186"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="1651.0186" y2="1651.0186"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1369" y1="1654.0186" y2="1654.0186"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="119" x="625" y="1640.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101" x="631" y="1656.9316">5. serverToken</text><line style="stroke:#181818;stroke-width:1.0;" x1="409" x2="451" y1="1725.6055" y2="1725.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="451" x2="451" y1="1725.6055" y2="1738.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="451" y1="1738.6055" y2="1738.6055"/><polygon fill="#181818" points="420,1734.6055,410,1738.6055,420,1742.6055,416,1738.6055" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="416" y="1705.5527">(20)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="448" y="1690.2422">Decrypt Response Data</text><ellipse cx="453.5" cy="1700.7949" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="460" y="1705.5527">tmp = debase(encStd)</text><ellipse cx="453.5" cy="1716.1055" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="460" y="1720.8633">std = dec(tmp, sesKey, iv, padding)</text><line style="stroke:#181818;stroke-width:1.0;" x1="409" x2="451" y1="1783.2266" y2="1783.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="451" x2="451" y1="1783.2266" y2="1796.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="410" x2="451" y1="1796.2266" y2="1796.2266"/><polygon fill="#181818" points="420,1792.2266,410,1796.2266,420,1800.2266,416,1796.2266" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="416" y="1770.8291">(21)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="448" y="1763.1738">Generate Server Token</text><ellipse cx="453.5" cy="1773.7266" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="460" y="1778.4844">serverToken = sha256(std)</text><polygon fill="#32CD32" points="371,1809.2266,1005,1809.2266,1015,1828.2266,1005,1847.2266,371,1847.2266,361,1828.2266,371,1809.2266" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="567.75" y="1825.7949">1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="583.75" y="1825.7949">Technical English Translation for DID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="551.75" y="1841.1055">When accessing TAS, submit the serverToken.</text><!--SRC=[lLRVR-9647wk_ufHUC4-7r7JInyYG48GNQFcrAZGvA5NLOizXDMPjUjTI5EK__rcTetnBv9MEjKI4jwTcU-RcM_MQwH9qFjkgEK_U7LnEPvZliCS5kaNL33DKHYPgk4vRuyzL34Ow-29hKdLThCasxFXSjpl-SFpvVZCypAH6nd9J2W3Pq7m8984JH2SWT3m918O3jtIUDmqdIAzhYJ6CCcomYCIv42lRrW3qvOHbbuPkRbKsfwBIM5cw5SnyqHav4uO97_ForLA_r8k1j7sW9uW-Fqkn_SnhgJ2-8yWSAlmCBczlLxyUJE34RZau6PMtvjLD-d5bj92UETGWIBarv0cTtSEPif9bo0QzS_u748cubYgHzh_Y0fpIYM69sdMi9ZCGH3YzNJsqobegiQhs6-2M4uTADve1DyFO2uVAPuhmOrQfJ0QUTwwLkNGTgvtApVuCKTK1VAJzN6IFA8Mos1utSAj7HnfvltOQktTkolu5V_QeZO5VDaV9h2l17wnMEpaVA-0Ya32GPW98w3oV5O1o9YxMRQziHjNjsVj_OBu2FOo3jcw3LucMUNR2ADI5M6r83aLFzr0CPPDKfI6TgWEFtG1sjXSgGDk8qYMIz80nPXepVENAbwoC_E5rblMQReYOqq1dKE_O14MaVmMUByf4ry_oNhWLWgXGthnSZJRNC6UN5wix2u6C366seynYRDKdLC8Qwr38NQooFApshjnSnLYQ-VqkZG4uN3xYr5jbsGdO-hEY88KVnaitzY3zfkrsB88IxXQhwkPs9ajcN0519KGJ_VTLbDygyvNgVGRdVA5w6XyTs8j1P2lKy0F0t07l9toELA3gmgeJ9exNwn59PD-mzlNDGEcb6tpBDN4WMGNGedyeOPifN94vazFJNjTdrqICe6vfh63yxk2Uypbwlbqj-v58cDEYTq7n6gmOmyPTMgi_ql6ooBn3u5BFNn2bfbUomoApst4OU-dhoDI2Mg8hGJwZSBusl38x1ljfgUeBKk98vUbRXcw0y5ENfcrMnlm8TkoZyIa6DIISY6jbkcEa_jD6PcGzVNVcSoVUVAxMBmntXqU_sN20TfQ-5zcbzfJdzigWv9vLSCSI1-RpE7MukBoHmxL3d6jelmvCpGDEakLFl7DtLNBT7FVt3URZ0nGHOxkuReYT-MLnM-waF7SAc-pJOnSqldKfoX-UOgmhxDn8tqvg2TLEqXcU2A98xaOBOOBwH_sdFXZZ1YyctZNUVNlorszPKKYjALlNB9wlHuiC5eh6jc4-l6OI4tNHXAZJfnYICJsudgetyEQS4GKeTPy6wGR9b7VBZUIRcHhhB8P72zdNm40]--></g></svg>