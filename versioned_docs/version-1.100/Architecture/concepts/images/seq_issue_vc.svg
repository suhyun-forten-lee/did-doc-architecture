<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="4536px" preserveAspectRatio="none" style="width:1441px;height:4536px;background:#FFFFFF;" version="1.1" viewBox="0 0 1441 4536" width="1441px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="25" font-weight="bold" lengthAdjust="spacing" textLength="149" x="642.25" y="43.8452">VC Issuance</text><rect fill="#FDF5E6" height="4469.4321" style="stroke:#181818;stroke-width:0.5;" width="316.5" x="50" y="61.3384"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="43" x="184.75" y="76.3379">Mobile</text><rect fill="#FFFFFF" height="4289.9731" style="stroke:#181818;stroke-width:1.0;" width="10" x="76.5" y="149.5679"/><rect fill="#FFFFFF" height="105.4238" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="867.0757"/><rect fill="#FFFFFF" height="1408.7979" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="2767.8955"/><rect fill="#FFFFFF" height="265.8477" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="398.1274"/><rect fill="#FFFFFF" height="287.9214" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="1029.2114"/><rect fill="#FFFFFF" height="291.4155" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="1822.6489"/><rect fill="#FFFFFF" height="382.1274" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="2272.3442"/><rect fill="#FFFFFF" height="659.543" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="3315.0146"/><rect fill="#FFFFFF" height="158.2798" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="4272.2612"/><rect fill="#FFFFFF" height="121.5679" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="510.5513"/><rect fill="#FFFFFF" height="175.1357" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="2402.624"/><rect fill="#FFFFFF" height="452.5513" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="3490.1504"/><rect fill="#FFFFFF" height="76.7119" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="4321.9731"/><rect fill="none" height="175.1006" style="stroke:#000000;stroke-width:1.5;" width="805.5" x="44" y="805.3989"/><rect fill="none" height="64.8208" style="stroke:#000000;stroke-width:1.5;" width="269.5" x="706" y="1044.2114"/><rect fill="none" height="64.8208" style="stroke:#000000;stroke-width:1.5;" width="250" x="706" y="1221.4561"/><rect fill="none" height="64.8208" style="stroke:#000000;stroke-width:1.5;" width="264.5" x="44" y="1332.1328"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="139.5679" y2="4448.541"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="81" x2="81" y1="139.5679" y2="4448.541"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="327.5" x2="327.5" y1="139.5679" y2="4448.541"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="751" x2="751" y1="139.5679" y2="4448.541"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1080" x2="1080" y1="139.5679" y2="4448.541"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="5" y="136.4917">User</text><ellipse cx="24.5" cy="68.8384" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M24.5,76.8384 L24.5,103.8384 M11.5,84.8384 L37.5,84.8384 M24.5,103.8384 L11.5,118.8384 M24.5,103.8384 L37.5,118.8384 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="5" y="4463.6943">User</text><ellipse cx="24.5" cy="4475.2705" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M24.5,4483.2705 L24.5,4510.2705 M11.5,4491.2705 L37.5,4491.2705 M24.5,4510.2705 L11.5,4525.2705 M24.5,4510.2705 L37.5,4525.2705 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="54" y="86.1089"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="41" x="61" y="109.2622">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="37" x="63" y="128.4917">CApp</text><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="54" y="4447.541"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="41" x="61" y="4470.6943">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="37" x="63" y="4489.9238">CApp</text><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="292.5" y="86.1089"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="56" x="299.5" y="109.2622">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="43" x="306" y="128.4917">Wallet</text><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="292.5" y="4447.541"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="56" x="299.5" y="4470.6943">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="43" x="306" y="4489.9238">Wallet</text><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="716" y="86.1089"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="723" y="109.2622">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="26" x="738.5" y="128.4917">TAS</text><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="716" y="4447.541"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="723" y="4470.6943">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="26" x="738.5" y="4489.9238">TAS</text><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1045" y="86.1089"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="1052" y="109.2622">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1058.5" y="128.4917">Issuer</text><rect fill="#E2E2F0" height="52.459" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1045" y="4447.541"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="1052" y="4470.6943">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1058.5" y="4489.9238">Issuer</text><rect fill="#FFFFFF" height="4289.9731" style="stroke:#181818;stroke-width:1.0;" width="10" x="76.5" y="149.5679"/><rect fill="#FFFFFF" height="105.4238" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="867.0757"/><rect fill="#FFFFFF" height="1408.7979" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="2767.8955"/><rect fill="#FFFFFF" height="265.8477" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="398.1274"/><rect fill="#FFFFFF" height="287.9214" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="1029.2114"/><rect fill="#FFFFFF" height="291.4155" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="1822.6489"/><rect fill="#FFFFFF" height="382.1274" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="2272.3442"/><rect fill="#FFFFFF" height="659.543" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="3315.0146"/><rect fill="#FFFFFF" height="158.2798" style="stroke:#181818;stroke-width:1.0;" width="10" x="746.5" y="4272.2612"/><rect fill="#FFFFFF" height="121.5679" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="510.5513"/><rect fill="#FFFFFF" height="175.1357" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="2402.624"/><rect fill="#FFFFFF" height="452.5513" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="3490.1504"/><rect fill="#FFFFFF" height="76.7119" style="stroke:#181818;stroke-width:1.0;" width="10" x="1075.5" y="4321.9731"/><polygon fill="#32CD32" points="62,154.5679,1099,154.5679,1109,175.5679,1099,197.5679,62,197.5679,52,175.5679,62,154.5679" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="455" y="173.5674">Information obtained through initiation stage</text><ellipse cx="460.5" cy="186.7798" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="467" y="191.4233">vcPlanId, (optional)issuer, (optional)offerId</text><rect fill="#FEFFDD" height="97" style="stroke:#181818;stroke-width:0.5;" width="1057" x="52" y="208.2798"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="283" y="227.2793">(Optional)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="595" x="283" y="245.1353">Before Request Issue Profile, KYC can be performed for TAS to obtain a personal identification number.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="450" x="283" y="262.9912">CApp can perform KYC and provide the personal identification number to TAS.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="283" y="280.8472">&#160;</text><ellipse cx="288.5" cy="294.0596" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="295" y="298.7031">pii = personal identification number</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1434.5" x="0" y="332.4875"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="332.4875" y2="332.4875"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="335.4875" y2="335.4875"/><rect fill="#EEEEEE" height="25.856" style="stroke:#000000;stroke-width:2.0;" width="143" x="645.75" y="320.5596"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125" x="651.75" y="339.5591">1. Propose Issue VC</text><polygon fill="#181818" points="734.5,394.1274,744.5,398.1274,734.5,402.1274,738.5,398.1274" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="740.5" y1="398.1274" y2="398.1274"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="93.5" y="384.343">(1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="112.5" y="375.415">Propose Issue VC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="112.5" y="393.271">{vcPlanId[, issuer, offerId]}</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="447.8394" y2="447.8394"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="447.8394" y2="460.8394"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="460.8394" y2="460.8394"/><polygon fill="#181818" points="767.5,456.8394,757.5,460.8394,767.5,464.8394,763.5,460.8394" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="763.5" y="434.0549">(2)</text><ellipse cx="788" cy="420.4834" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="794.5" y="425.127">Validate VC plan</text><ellipse cx="788" cy="438.3394" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="794.5" y="442.9829">Identify issuing issuer</text><path d="M931,423.5554 L931,450.5554 L1345,450.5554 L1345,433.5554 L1335,423.5554 L931,423.5554 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1335,423.5554 L1335,433.5554 L1345,433.5554 L1335,423.5554 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="937" y="443.5549">Issuer identification is done by checking TAS DB or internal settings</text><polygon fill="#181818" points="1063.5,506.5513,1073.5,510.5513,1063.5,514.5513,1067.5,510.5513" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="1069.5" y1="510.5513" y2="510.5513"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="763.5" y="496.7668">(3)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="782.5" y="487.8389">Inspect Propose</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="782.5" y="505.6948">{vcPlanId[, issuer, offerId]}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="542.4072" y2="542.4072"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="542.4072" y2="555.4072"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="555.4072" y2="555.4072"/><polygon fill="#181818" points="1096.5,551.4072,1086.5,555.4072,1096.5,559.4072,1092.5,555.4072" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="1092.5" y="537.5508">(4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="1111.5" y="537.5508">Check if VC issuance is possible</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="587.2632" y2="587.2632"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="587.2632" y2="600.2632"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="600.2632" y2="600.2632"/><polygon fill="#181818" points="1096.5,596.2632,1086.5,600.2632,1096.5,604.2632,1092.5,600.2632" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="1092.5" y="582.4067">(5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="1111.5" y="582.4067">refId = Generate reference number</text><polygon fill="#181818" points="767.5,628.1191,757.5,632.1191,767.5,636.1191,763.5,632.1191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="761.5" x2="1079.5" y1="632.1191" y2="632.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="773.5" y="627.2627">(6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="792.5" y="627.2627">{refId}</text><polygon fill="#181818" points="97.5,659.9751,87.5,663.9751,97.5,667.9751,93.5,663.9751" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="750.5" y1="663.9751" y2="663.9751"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="103.5" y="659.1187">(7)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="122.5" y="659.1187">{refId}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1434.5" x="0" y="693.9031"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="693.9031" y2="693.9031"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="696.9031" y2="696.9031"/><rect fill="#EEEEEE" height="25.856" style="stroke:#000000;stroke-width:2.0;" width="123" x="655.75" y="681.9751"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105" x="661.75" y="700.9746">2. Request ECDH</text><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="128.5" y1="777.3989" y2="777.3989"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="777.3989" y2="790.3989"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="128.5" y1="790.3989" y2="790.3989"/><polygon fill="#181818" points="97.5,786.3989,87.5,790.3989,97.5,794.3989,93.5,790.3989" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="93.5" y="754.6865">(8)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="112.5" y="736.8306">Prepare and sign ECDH data</text><ellipse cx="118" cy="750.043" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="124.5" y="754.6865">(ReqEcdh)reqEcdh</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="124.5" y="772.5425">= Create ECDH request</text><path d="M44,805.3989 L109,805.3989 L109,815.2549 L99,825.2549 L44,825.2549 L44,805.3989 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="175.1006" style="stroke:#000000;stroke-width:1.5;" width="805.5" x="44" y="805.3989"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="59" y="821.3984">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165" x="124" y="820.0908">[KeyAgreement Signature ON]</text><polygon fill="#181818" points="310.5,863.0757,320.5,867.0757,310.5,871.0757,314.5,867.0757" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="316.5" y1="867.0757" y2="867.0757"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="93.5" y="853.2913">(9)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="112.5" y="844.3633">Request KeyAgreement Signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="112.5" y="862.2192">{reqEcdh}</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="913.2876" y2="913.2876"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="913.2876" y2="926.2876"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="926.2876" y2="926.2876"/><polygon fill="#181818" points="343.5,922.2876,333.5,926.2876,343.5,930.2876,339.5,926.2876" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="908.4312">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="365.5" y="908.4312">signKeyAgree(reqEcdh)</text><path d="M514,880.0757 L514,943.0757 L829,943.0757 L829,890.0757 L819,880.0757 L514,880.0757 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M819,880.0757 L819,890.0757 L829,890.0757 L819,880.0757 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="520" y="900.0752">During actual call:</text><ellipse cx="525.5" cy="913.2876" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282" x="532" y="917.9312">CApp provides hash of the original text and keyId</text><ellipse cx="525.5" cy="931.1436" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="532" y="935.7871">Wallet responds with the signature value only</text><polygon fill="#181818" points="97.5,968.4995,87.5,972.4995,97.5,976.4995,93.5,972.4995" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="326.5" y1="972.4995" y2="972.4995"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="103.5" y="967.6431">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="129.5" y="967.6431">{reqEcdh}</text><polygon fill="#181818" points="734.5,1025.2114,744.5,1029.2114,734.5,1033.2114,738.5,1029.2114" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="740.5" y1="1029.2114" y2="1029.2114"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="1015.427">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="119.5" y="1006.499">Request ECDH</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="119.5" y="1024.355">{reqEcdh}</text><path d="M706,1044.2114 L771,1044.2114 L771,1054.0674 L761,1064.0674 L706,1064.0674 L706,1044.2114 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="64.8208" style="stroke:#000000;stroke-width:1.5;" width="269.5" x="706" y="1044.2114"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="721" y="1060.2109">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165" x="786" y="1058.9033">[KeyAgreement Signature ON]</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="1088.0322" y2="1088.0322"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="1088.0322" y2="1101.0322"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="1101.0322" y2="1101.0322"/><polygon fill="#181818" points="767.5,1097.0322,757.5,1101.0322,767.5,1105.0322,763.5,1101.0322" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="1083.1758">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="789.5" y="1083.1758">Verify reqEcdh.proof signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="1193.4561" y2="1193.4561"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="1193.4561" y2="1206.4561"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="1206.4561" y2="1206.4561"/><polygon fill="#181818" points="767.5,1202.4561,757.5,1206.4561,767.5,1210.4561,763.5,1206.4561" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="1161.8157">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="789.5" y="1135.0317">Perform ECDH</text><ellipse cx="795" cy="1148.2441" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="801.5" y="1152.8877">sesKey = Session key</text><ellipse cx="795" cy="1166.1001" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="801.5" y="1170.7437">(AccEcdh)accEcdh</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="801.5" y="1188.5996">= Create ECDH acceptance</text><path d="M706,1221.4561 L771,1221.4561 L771,1231.312 L761,1241.312 L706,1241.312 L706,1221.4561 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="64.8208" style="stroke:#000000;stroke-width:1.5;" width="250" x="706" y="1221.4561"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="721" y="1237.4556">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165" x="786" y="1236.1479">[KeyAgreement Signature ON]</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="1265.2769" y2="1265.2769"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="1265.2769" y2="1278.2769"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="1278.2769" y2="1278.2769"/><polygon fill="#181818" points="767.5,1274.2769,757.5,1278.2769,767.5,1282.2769,763.5,1278.2769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="1260.4204">(15)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="789.5" y="1260.4204">signKeyAgree(accEcdh)</text><polygon fill="#181818" points="97.5,1313.1328,87.5,1317.1328,97.5,1321.1328,93.5,1317.1328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="750.5" y1="1317.1328" y2="1317.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="103.5" y="1312.2764">(16)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="129.5" y="1312.2764">{accEcdh}</text><path d="M44,1332.1328 L109,1332.1328 L109,1341.9888 L99,1351.9888 L44,1351.9888 L44,1332.1328 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="64.8208" style="stroke:#000000;stroke-width:1.5;" width="264.5" x="44" y="1332.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="59" y="1348.1323">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165" x="124" y="1346.8247">[KeyAgreement Signature ON]</text><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="128.5" y1="1375.9536" y2="1375.9536"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="1375.9536" y2="1388.9536"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="128.5" y1="1388.9536" y2="1388.9536"/><polygon fill="#181818" points="97.5,1384.9536,87.5,1388.9536,97.5,1392.9536,93.5,1388.9536" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="1371.0972">(17)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="119.5" y="1371.0972">Verify accEcdh.proof signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="128.5" y1="1445.6655" y2="1445.6655"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="1445.6655" y2="1458.6655"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="128.5" y1="1458.6655" y2="1458.6655"/><polygon fill="#181818" points="97.5,1454.6655,87.5,1458.6655,97.5,1462.6655,93.5,1458.6655" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="1431.8811">(18)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="119.5" y="1422.9531">Perform ECDH</text><ellipse cx="125" cy="1436.1655" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="131.5" y="1440.8091">sesKey = Session key</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1434.5" x="0" y="1488.5935"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="1488.5935" y2="1488.5935"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="1491.5935" y2="1491.5935"/><rect fill="#EEEEEE" height="25.856" style="stroke:#000000;stroke-width:2.0;" width="173" x="630.75" y="1476.6655"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155" x="636.75" y="1495.665">3. Request Create Token</text><polygon fill="#32CD32" points="38,1517.5215,370,1517.5215,380,1547.5215,370,1578.5215,38,1578.5215,28,1547.5215,38,1517.5215" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="45.5" cy="1531.8774" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="52" y="1536.521">purpose = "IssueVc"</text><ellipse cx="45.5" cy="1549.7334" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316" x="52" y="1554.377">(SignedWalletInfo)walletInfo = Create wallet information</text><ellipse cx="45.5" cy="1567.5894" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="52" y="1572.2329">walletToken = Wallet token</text><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="128.5" y1="1625.8013" y2="1625.8013"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="1625.8013" y2="1638.8013"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="128.5" y1="1638.8013" y2="1638.8013"/><polygon fill="#181818" points="97.5,1634.8013,87.5,1638.8013,97.5,1642.8013,93.5,1638.8013" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="1612.0168">(19)</text><ellipse cx="125" cy="1598.4453" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="131.5" y="1603.0889">(AttestedAppInfo)caAppInfo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="131.5" y="1620.9448">= Create signed app information</text><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="128.5" y1="1759.937" y2="1759.937"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="1759.937" y2="1772.937"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="128.5" y1="1772.937" y2="1772.937"/><polygon fill="#181818" points="97.5,1768.937,87.5,1772.937,97.5,1776.937,93.5,1772.937" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="1710.4407">(20)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="119.5" y="1665.8008">Generate server token seed</text><ellipse cx="125" cy="1679.0132" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="131.5" y="1683.6567">(ServerTokenSeed)seed = {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="139.5" y="1701.5127">purpose = "IssueVc",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="139.5" y="1719.3687">walletInfo,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="139.5" y="1737.2246">caAppInfo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="127.5" y="1755.0806">}</text><polygon fill="#181818" points="734.5,1818.6489,744.5,1822.6489,734.5,1826.6489,738.5,1822.6489" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="740.5" y1="1822.6489" y2="1822.6489"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="1808.8645">(21)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="119.5" y="1799.9365">Request Create Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="119.5" y="1817.7925">{seed}</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="1890.2168" y2="1890.2168"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="1890.2168" y2="1903.2168"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="1903.2168" y2="1903.2168"/><polygon fill="#181818" points="767.5,1899.2168,757.5,1903.2168,767.5,1907.2168,763.5,1903.2168" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="1867.5044">(22)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="789.5" y="1849.6484">Verify signatures</text><ellipse cx="795" cy="1862.8608" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="801.5" y="1867.5044">Verify wallet signature</text><ellipse cx="795" cy="1880.7168" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="801.5" y="1885.3604">Verify CApp provider signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="1970.7847" y2="1970.7847"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="1970.7847" y2="1983.7847"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="1983.7847" y2="1983.7847"/><polygon fill="#181818" points="767.5,1979.7847,757.5,1983.7847,767.5,1987.7847,763.5,1983.7847" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="1948.0723">(23)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="789.5" y="1930.2163">Generate and store server token</text><ellipse cx="795" cy="1943.4287" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="801.5" y="1948.0723">Create (ServerTokenData)std</text><ellipse cx="795" cy="1961.2847" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="801.5" y="1965.9282">serverToken = sha256(std)</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="2069.2085" y2="2069.2085"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="2069.2085" y2="2082.2085"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="2082.2085" y2="2082.2085"/><polygon fill="#181818" points="767.5,2078.2085,757.5,2082.2085,767.5,2086.2085,763.5,2082.2085" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="2037.5681">(24)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="789.5" y="2010.7842">Encrypt response information</text><ellipse cx="795" cy="2023.9966" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="801.5" y="2028.6401">iv = Generate IV</text><ellipse cx="795" cy="2041.8525" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="801.5" y="2046.4961">tmp = enc(std, sesKey, iv)</text><ellipse cx="795" cy="2059.7085" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="801.5" y="2064.3521">encStd = multibase(tmp)</text><polygon fill="#181818" points="97.5,2110.0645,87.5,2114.0645,97.5,2118.0645,93.5,2114.0645" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="750.5" y1="2114.0645" y2="2114.0645"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="103.5" y="2109.208">(25)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="129.5" y="2109.208">{iv, encStd}</text><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="128.5" y1="2163.7764" y2="2163.7764"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="2163.7764" y2="2176.7764"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="128.5" y1="2176.7764" y2="2176.7764"/><polygon fill="#181818" points="97.5,2172.7764,87.5,2176.7764,97.5,2180.7764,93.5,2176.7764" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="2149.9919">(26)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="119.5" y="2141.064">Encrypt and Prepare Data</text><ellipse cx="125" cy="2154.2764" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="131.5" y="2158.9199">Calculate serverToken</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1434.5" x="0" y="2206.7043"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="2206.7043" y2="2206.7043"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="2209.7043" y2="2209.7043"/><rect fill="#EEEEEE" height="25.856" style="stroke:#000000;stroke-width:2.0;" width="166" x="634.25" y="2194.7764"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148" x="640.25" y="2213.7759">4. Request Issue Profile</text><polygon fill="#181818" points="734.5,2268.3442,744.5,2272.3442,734.5,2276.3442,738.5,2272.3442" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="740.5" y1="2272.3442" y2="2272.3442"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="2258.5598">(27)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="119.5" y="2249.6318">Request Issue Profile</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="119.5" y="2267.4878">{serverToken}</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="2339.9121" y2="2339.9121"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="2339.9121" y2="2352.9121"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="2352.9121" y2="2352.9121"/><polygon fill="#181818" points="767.5,2348.9121,757.5,2352.9121,767.5,2356.9121,763.5,2352.9121" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="2317.1997">(28)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="789.5" y="2299.3438">Confirm authorization and identify holder</text><ellipse cx="795" cy="2312.5562" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="801.5" y="2317.1997">Verify serverToken</text><ellipse cx="795" cy="2330.4121" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="801.5" y="2335.0557">holderDid = Holder DID</text><polygon fill="#181818" points="1063.5,2398.624,1073.5,2402.624,1063.5,2406.624,1067.5,2402.624" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="1069.5" y1="2402.624" y2="2402.624"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="2388.8396">(29)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="789.5" y="2379.9116">Generate Profile</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="789.5" y="2397.7676">{holderDid[, pii]}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="2488.0479" y2="2488.0479"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="2488.0479" y2="2501.0479"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="2501.0479" y2="2501.0479"/><polygon fill="#181818" points="1096.5,2497.0479,1086.5,2501.0479,1096.5,2505.0479,1092.5,2501.0479" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="2456.4075">(30)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="1118.5" y="2429.6235">Prepare profile-related data</text><ellipse cx="1124" cy="2442.8359" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="1130.5" y="2447.4795">issuerNonce = Generate nonce for issuance</text><ellipse cx="1124" cy="2460.6919" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="1130.5" y="2465.3354">(ReqE2e)reqE2e = Create E2E request information</text><ellipse cx="1124" cy="2478.5479" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="1130.5" y="2483.1914">Other data omitted</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="2532.9038" y2="2532.9038"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="2532.9038" y2="2545.9038"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="2545.9038" y2="2545.9038"/><polygon fill="#181818" points="1096.5,2541.9038,1086.5,2545.9038,1096.5,2549.9038,1092.5,2545.9038" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="2528.0474">(31)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="1118.5" y="2528.0474">(IssueProfile)profile = Create profile</text><polygon fill="#181818" points="767.5,2573.7598,757.5,2577.7598,767.5,2581.7598,763.5,2577.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="761.5" x2="1079.5" y1="2577.7598" y2="2577.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="773.5" y="2572.9033">(32)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="799.5" y="2572.9033">{profile}</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="2609.6157" y2="2609.6157"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="2609.6157" y2="2622.6157"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="2622.6157" y2="2622.6157"/><polygon fill="#181818" points="767.5,2618.6157,757.5,2622.6157,767.5,2626.6157,763.5,2622.6157" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="2604.7593">(33)</text><ellipse cx="795" cy="2600.1157" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="801.5" y="2604.7593">authNonce = Generate nonce for DID Auth</text><polygon fill="#181818" points="97.5,2650.4717,87.5,2654.4717,97.5,2658.4717,93.5,2654.4717" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="750.5" y1="2654.4717" y2="2654.4717"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="103.5" y="2649.6152">(34)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="129.5" y="2649.6152">{authNonce, profile}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1434.5" x="0" y="2684.3997"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="2684.3997" y2="2684.3997"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="2687.3997" y2="2687.3997"/><rect fill="#EEEEEE" height="25.856" style="stroke:#000000;stroke-width:2.0;" width="142" x="646.25" y="2672.4717"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="124" x="652.25" y="2691.4712">5. Request Issue VC</text><polygon fill="#181818" points="310.5,2763.8955,320.5,2767.8955,310.5,2771.8955,314.5,2767.8955" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="316.5" y1="2767.8955" y2="2767.8955"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="2745.1831">(35)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="119.5" y="2727.3271">Request VC Issuance</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="119.5" y="2745.1831">{walletToken, serverToken,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="131.5" y="2763.0391">refId, authNonce, profile}</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="2799.7515" y2="2799.7515"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="2799.7515" y2="2812.7515"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="2812.7515" y2="2812.7515"/><polygon fill="#181818" points="343.5,2808.7515,333.5,2812.7515,343.5,2816.7515,339.5,2812.7515" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="2794.895">(36)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="365.5" y="2794.895">Verify walletToken</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="2844.6074" y2="2844.6074"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="2844.6074" y2="2857.6074"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="2857.6074" y2="2857.6074"/><polygon fill="#181818" points="343.5,2853.6074,333.5,2857.6074,343.5,2861.6074,339.5,2857.6074" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="2839.751">(37)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="365.5" y="2839.751">Verify profile.proof signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="2960.8872" y2="2960.8872"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="2960.8872" y2="2973.8872"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="2973.8872" y2="2973.8872"/><polygon fill="#181818" points="343.5,2969.8872,333.5,2973.8872,343.5,2977.8872,339.5,2973.8872" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="2920.3188">(38)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="365.5" y="2884.6069">Prepare DID Auth data</text><ellipse cx="371" cy="2897.8193" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="377.5" y="2902.4629">(DidAuth)didAuth = {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="385.5" y="2920.3188">did = Holder DID,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="385.5" y="2938.1748">authNonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="373.5" y="2956.0308">}</text><polygon fill="#0000FF" points="310.5,3001.7432,320.5,3005.7432,310.5,3005.7432" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="24.5" x2="321.5" y1="3005.7432" y2="3005.7432"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="31.5" y="3000.8867">(39)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="57.5" y="3000.8867">User authentication</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="3037.5991" y2="3037.5991"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="3037.5991" y2="3050.5991"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="3050.5991" y2="3050.5991"/><polygon fill="#181818" points="343.5,3046.5991,333.5,3050.5991,343.5,3054.5991,339.5,3050.5991" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="3032.7427">(40)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="365.5" y="3032.7427">signAuth(didAuth)</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="3171.7349" y2="3171.7349"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="3171.7349" y2="3184.7349"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="3184.7349" y2="3184.7349"/><polygon fill="#181818" points="343.5,3180.7349,333.5,3184.7349,343.5,3188.7349,339.5,3184.7349" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="3122.2385">(41)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="365.5" y="3077.5986">Perform E2E ECDH</text><ellipse cx="371" cy="3090.811" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="377.5" y="3095.4546">_, pubKeyE2E = Generate ECC key pair</text><ellipse cx="371" cy="3108.667" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362" x="377.5" y="3113.3105">e2eKey = Generate encryption key using E2E data from profile</text><ellipse cx="371" cy="3126.5229" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="377.5" y="3131.1665">iv = Generate IV</text><ellipse cx="371" cy="3144.3789" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="377.5" y="3149.0225">(AccE2e)accE2e = {pubKeyE2E, iv}</text><ellipse cx="371" cy="3162.2349" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="377.5" y="3166.8784">signKeyAgree(accE2e)</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="3252.3027" y2="3252.3027"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="3252.3027" y2="3265.3027"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="3265.3027" y2="3265.3027"/><polygon fill="#181818" points="343.5,3261.3027,333.5,3265.3027,343.5,3269.3027,339.5,3265.3027" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="3229.5903">(42)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="365.5" y="3211.7344">Generate and encrypt issuance request information</text><ellipse cx="371" cy="3224.9468" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="377.5" y="3229.5903">Create (ReqVc)reqVc</text><ellipse cx="371" cy="3242.8027" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="377.5" y="3247.4463">encReqVc = enc(data, e2eKey, iv)</text><polygon fill="#181818" points="734.5,3311.0146,744.5,3315.0146,734.5,3319.0146,738.5,3315.0146" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="740.5" y1="3315.0146" y2="3315.0146"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="3301.2302">(43)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="365.5" y="3292.3022">Request Issue VC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="365.5" y="3310.1582">{serverToken, didAuth, accE2e, encReqVc}</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="3346.8706" y2="3346.8706"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="3346.8706" y2="3359.8706"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="3359.8706" y2="3359.8706"/><polygon fill="#181818" points="767.5,3355.8706,757.5,3359.8706,767.5,3363.8706,763.5,3359.8706" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="3342.0142">(44)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="789.5" y="3342.0142">Verify serverToken</text><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="798.5" y1="3427.4385" y2="3427.4385"/><line style="stroke:#181818;stroke-width:1.0;" x1="798.5" x2="798.5" y1="3427.4385" y2="3440.4385"/><line style="stroke:#181818;stroke-width:1.0;" x1="757.5" x2="798.5" y1="3440.4385" y2="3440.4385"/><polygon fill="#181818" points="767.5,3436.4385,757.5,3440.4385,767.5,3444.4385,763.5,3440.4385" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="3404.7261">(45)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="789.5" y="3386.8701">Verify DID Auth</text><ellipse cx="795" cy="3400.0825" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="801.5" y="3404.7261">Verify didAuth.proof</text><ellipse cx="795" cy="3417.9385" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="801.5" y="3422.582">Check authNonce match</text><polygon fill="#181818" points="1063.5,3486.1504,1073.5,3490.1504,1063.5,3494.1504,1067.5,3490.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="1069.5" y1="3490.1504" y2="3490.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="3476.366">(46)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="789.5" y="3467.438">Issue VC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="789.5" y="3485.2939">{accE2e, encReqVc}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="3575.5742" y2="3575.5742"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="3575.5742" y2="3588.5742"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="3588.5742" y2="3588.5742"/><polygon fill="#181818" points="1096.5,3584.5742,1086.5,3588.5742,1096.5,3592.5742,1092.5,3588.5742" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="3543.9338">(47)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="1118.5" y="3517.1499">Perform E2E ECDH</text><ellipse cx="1124" cy="3530.3623" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="1130.5" y="3535.0059">Verify accE2e.proof</text><ellipse cx="1124" cy="3548.2183" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="1130.5" y="3552.8618">Generate e2eKey</text><ellipse cx="1124" cy="3566.0742" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="1130.5" y="3570.7178">iv = accE2e.iv</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="3656.1421" y2="3656.1421"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="3656.1421" y2="3669.1421"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="3669.1421" y2="3669.1421"/><polygon fill="#181818" points="1096.5,3665.1421,1086.5,3669.1421,1096.5,3673.1421,1092.5,3669.1421" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="3633.4297">(48)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1118.5" y="3615.5737">Decrypt encReqVc</text><ellipse cx="1124" cy="3628.7861" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="1130.5" y="3633.4297">tmp = debase(encReqVc)</text><ellipse cx="1124" cy="3646.6421" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1130.5" y="3651.2856">reqVc = dec(tmp, e2eKey, iv)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="3754.5659" y2="3754.5659"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="3754.5659" y2="3767.5659"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="3767.5659" y2="3767.5659"/><polygon fill="#181818" points="1096.5,3763.5659,1086.5,3767.5659,1096.5,3771.5659,1092.5,3767.5659" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="3722.9255">(49)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="1118.5" y="3696.1416">Verify reqVc against IssueProfile</text><ellipse cx="1124" cy="3709.354" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="1130.5" y="3713.9976">Check refId match</text><ellipse cx="1124" cy="3727.21" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1130.5" y="3731.8535">Check profile.id match</text><ellipse cx="1124" cy="3745.0659" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="1130.5" y="3749.7095">Check profile.issuerNonce match</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="3799.4219" y2="3799.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="3799.4219" y2="3812.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="3812.4219" y2="3812.4219"/><polygon fill="#181818" points="1096.5,3808.4219,1086.5,3812.4219,1096.5,3816.4219,1092.5,3812.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="3794.5654">(50)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="1118.5" y="3794.5654">vc =</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="124" x="1146.5" y="3794.5654">Issue or re-issue VC</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="3897.8457" y2="3897.8457"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="3897.8457" y2="3910.8457"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="3910.8457" y2="3910.8457"/><polygon fill="#181818" points="1096.5,3906.8457,1086.5,3910.8457,1096.5,3914.8457,1092.5,3910.8457" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="3866.2053">(51)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="1118.5" y="3839.4214">Encrypt vc</text><ellipse cx="1124" cy="3852.6338" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="1130.5" y="3857.2773">iv = Generate IV</text><ellipse cx="1124" cy="3870.4897" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="1130.5" y="3875.1333">tmp = enc(vc, e2eKey, iv)</text><ellipse cx="1124" cy="3888.3457" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="1130.5" y="3892.9893">encVc = multibase(tmp)</text><polygon fill="#181818" points="767.5,3938.7017,757.5,3942.7017,767.5,3946.7017,763.5,3942.7017" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="761.5" x2="1079.5" y1="3942.7017" y2="3942.7017"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="773.5" y="3937.8452">(52)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="799.5" y="3937.8452">{encVc, iv}</text><polygon fill="#181818" points="343.5,3970.5576,333.5,3974.5576,343.5,3978.5576,339.5,3974.5576" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="337.5" x2="750.5" y1="3974.5576" y2="3974.5576"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="349.5" y="3969.7012">(53)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="375.5" y="3969.7012">{encVc, iv}</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="4042.1255" y2="4042.1255"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="4042.1255" y2="4055.1255"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="4055.1255" y2="4055.1255"/><polygon fill="#181818" points="343.5,4051.1255,333.5,4055.1255,343.5,4059.1255,339.5,4055.1255" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="4019.4131">(54)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="365.5" y="4001.5571">Decrypt encVc</text><ellipse cx="371" cy="4014.7695" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="377.5" y="4019.4131">tmp = debase(encVc)</text><ellipse cx="371" cy="4032.6255" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="377.5" y="4037.269">vc = dec(tmp, e2eKey, iv)</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="4086.9814" y2="4086.9814"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="4086.9814" y2="4099.9814"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="4099.9814" y2="4099.9814"/><polygon fill="#181818" points="343.5,4095.9814,333.5,4099.9814,343.5,4103.9814,339.5,4099.9814" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="4082.125">(55)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="365.5" y="4082.125">Verify issuer signature and store</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="4131.8374" y2="4131.8374"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="4131.8374" y2="4144.8374"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="4144.8374" y2="4144.8374"/><polygon fill="#181818" points="343.5,4140.8374,333.5,4144.8374,343.5,4148.8374,339.5,4144.8374" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="339.5" y="4126.981">(56)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="365.5" y="4126.981">Extract vcId = VC id</text><polygon fill="#181818" points="97.5,4172.6934,87.5,4176.6934,97.5,4180.6934,93.5,4176.6934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="326.5" y1="4176.6934" y2="4176.6934"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="103.5" y="4171.8369">(57)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="129.5" y="4171.8369">{vcId}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1434.5" x="0" y="4206.6213"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="4206.6213" y2="4206.6213"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1434.5" y1="4209.6213" y2="4209.6213"/><rect fill="#EEEEEE" height="25.856" style="stroke:#000000;stroke-width:2.0;" width="141" x="646.75" y="4194.6934"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="123" x="652.75" y="4213.6929">6. Confirm Issue VC</text><polygon fill="#181818" points="734.5,4268.2612,744.5,4272.2612,734.5,4276.2612,738.5,4272.2612" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="740.5" y1="4272.2612" y2="4272.2612"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="93.5" y="4258.4768">(58)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="119.5" y="4249.5488">Confirm Issue VC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="119.5" y="4267.4048">{vcId}</text><polygon fill="#181818" points="1063.5,4317.9731,1073.5,4321.9731,1063.5,4325.9731,1067.5,4321.9731" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="756.5" x2="1069.5" y1="4321.9731" y2="4321.9731"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="763.5" y="4308.1887">(59)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="789.5" y="4299.2607">Complete VC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="789.5" y="4317.1167">{vcId}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1085.5" x2="1127.5" y1="4353.8291" y2="4353.8291"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="4353.8291" y2="4366.8291"/><line style="stroke:#181818;stroke-width:1.0;" x1="1086.5" x2="1127.5" y1="4366.8291" y2="4366.8291"/><polygon fill="#181818" points="1096.5,4362.8291,1086.5,4366.8291,1096.5,4370.8291,1092.5,4366.8291" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="1092.5" y="4348.9727">(60)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="1118.5" y="4348.9727">Check vcId and complete processing</text><polygon fill="#181818" points="767.5,4394.6851,757.5,4398.6851,767.5,4402.6851,763.5,4398.6851" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="761.5" x2="1079.5" y1="4398.6851" y2="4398.6851"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="773.5" y="4393.8286">(61)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="799.5" y="4393.8286">OK</text><polygon fill="#181818" points="97.5,4426.541,87.5,4430.541,97.5,4434.541,93.5,4430.541" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="750.5" y1="4430.541" y2="4430.541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="103.5" y="4425.6846">(62)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="129.5" y="4425.6846">OK</text><!--SRC=[dLXjRzis4FwkNq4aNspNIR5iwOV0Df3QGMkqQuAbop2qnK1BPvkeBMaKxJOjyjztTwGaYfAJTWOIM-JTyLwUUw6CCXk817v6XVe65sVdaxkfc1V5JgOnZ9xJuYI2D166AIEvCrcwsov0YwFHOj8xxe-UBoP7k16R3DS6WpyBq8F1aP25sE7FQ95z5Rzd2xK1SNozITxAs1wOIsrKh7AP6cARNkQvOukb68tmSJBf8lnBRZPW7EaNkK5QkpInYk9vKS3o_lBMqHly6urkGUz18tr0HtPNok-NFcMqJZC38iCdr6z8kyTlrHPUQO2KrPodoqnlfL5PAhA5aIe5zDfQPxlLMgXK6MNt2YDNrWC3iOzlDZAT9qFHotBQbPk-OYNybMov13rFs3fM8ufqg0qBx5sNBFpu4b0Z47_0lpie34SLn8tEbXYBeNZpznHvKx40aOCctL5V_1BeBM4oPuEGj5kGKA4II8rQgjWQOc5moaTHz5YQ4yNI9UgRwsoFVEW8U48GdOb7MtdEFxbIOlm47xj5MxUCn-ANKp8npmfm1YEUnsF6fzfBT5eiemWHTZ9XC3nxTj6Y_vX-BmFpOIZAUBWeV7fWtOZNYhX0FU_aHYKa70_BaV5ZEX1pg-mz2r3foWbYRewULgkruKU63- -69gf295aAOd4luZN4dqaEnMVsKc2aL6f0asCAC0Qt2fP6_c1tU7eYNCdIULha49lIuXynb3x8pJ8kn9IK46f9XYfN9KX9b5QeXIibJHODotc2KNm5AMZo4Iw01c9q0IHw3MQdK_6TgH-Yu942UtPQ8VbgEdlDGRLnZ2N5432PWJ5Ng5LgQJ0cijI8Oj932LTnikvh-rtluR-nc6eW1PbLsxEY2DDGl87xonLc-XQ38svHl4JrG5o_Ozsj5bIAoCUbajqyw79tTkrUuhG2BbZtahFdAFiLPGTkw3FRQG86Gdo7ecAiXXUD_O7DJvUBXLZBOerXvgJCK9mY31duQjXzd-4UYqsJtrPOT4gHPsc2TLUPDRCNbJFsSeFPawMR-ugtWSGwfCvyt0qpqGzmwAcdun3cvHreoZydvHJDHvihXSjSQQNpZIjX30FlGm0ge40T42gtW83714LdXJIzopZci4dxtTnl0Gsf83UKID7_jBE16NTelpAloYMty_33YAQySZvql2qVqW5U4dgUE-GjpkLVwrnshdYVVOQKSpfej9GSGQV5lh3JNB77ueZhvbryv7PwP0ia5g_KaljVgf-ru-qQri-gPJjsk-6KAL5lwD7llhN556rZq0v8CCFul5YwNzqnBrW_8J4V_UDhaLMTB7ZsiAVZ0pBv8BEJ2MjwYtjz9XYBxurJHPUdXW59xQ1mfzEKXqD9wqSIavSKQlTAXwSAGKMOFOx0HQWkBzraVbtJGMxxnrPEvVvWQ2ngk3UGxapndJp3Lj8lJDAk21K9EhbOoxFp5psawxTqk4fZVP-NHHHZuiK_bAhsViUStuNxPfiZ0JPHEche4WrR-BuVKYBDhI5aR7SRenQoW1uozwkgeFP3H_FW0xjKblnLzjPPq4sdSXFlDZLKsGcStx-TTa-TNjCEqTEWO_XK8jieccRfKc6XmTl86XlOD-j3qbMLKzSwsn0akc7Z1osWi7mpHIvxRMNCvhEEMQgAJgrpnOlJ58wkdHDKwSpSSfre80ycZL6bWGIUojvbD2zva4XvWSRrQWphOEPvvmnut3a3h_6SNPK3pY4KbYAkiSjhgrssLLZhaWwZUXmzvuX-NWQxFCujDCO0jzOrJLDK7p4Omo4kaQHkR2NzK5HI2ONd8GhTLQ1xNlFklHXAhn4CVRWqIoIFfqFHfK0us3NgcikK0pHEHkV0ufDNUUaSqXvt4OgqqK_iTqT_I0AWXosWZaMZ1T0lkjsBam_7Bt7k-_JHgaINV-QXB8phpXgEkAHDpsdLRpkY6YGGfrrZs3_ewDq2InuHU22vcavv8ikbQgK-d84THYfgi3Mk7EDs1GtH997zkDJPjWp5pvPd7W4nxoH_aTihTQb8FxIQI3Z18M_BAOqUvdIli_-9TFQx6YB-BgQQS1TtT0lUTSs5735qdkFkqWXLTmdd-tCZOroSXy9QDgnEUNXiRFTxoYDa5VWxQfSZSUUxVEgWixVQ6kheldWT7bfUeMiZ3viJbFn7qDoXhXNRhMr9McFOele06UFKoLFx0-hDm4AfYlq1ONRcI81dY9AuVuXQEnWb4DF0qKHHjoBrVGqvvKggj0JLJJiDs_6pBneuTeyJblLL_HorruYR06bQiIUhtRj4UacZuKGvp0m61tZAQMiVFnh90nMdUp3SnmsV7s90KevJC1wM96MFPJAkNT61vLQzyd3LBZGXc08a4Sd-KVXqz4qR8U_EK0txBOwhhqRBc1pExwReRLPIpHEqQ2U85wVLgDanGPJrBoJXrshpvkN7LOzfjisn_xUekjwoiMvaGbmo8HHZkacdApy8rs-Y-jT_]--></g></svg>