<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="676px" preserveAspectRatio="none" style="width:1139px;height:676px;background:#FFFFFF;" version="1.1" viewBox="0 0 1139 676" width="1139px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="25" font-weight="bold" lengthAdjust="spacing" textLength="286" x="428.75" y="39.1699">Server Token Creation</text><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="34.5" y="134.7305"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="681.5" y="193.3516"/><rect fill="#FFFFFF" height="198.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="809.5" y="294.2832"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="103.4199" y2="624.7676"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="256.5" x2="256.5" y1="103.4199" y2="624.7676"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="686" x2="686" y1="103.4199" y2="624.7676"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="814" x2="814" y1="103.4199" y2="624.7676"/><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="5" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="12" y="75.9785">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="17" y="92.4668">Wallet</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="5" y="623.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="12" y="644.3027">&#171;Wallet&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="17" y="660.791">Wallet</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="201.5" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="235.5" y="75.9785">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="96" x="208.5" y="92.4668">Certified App</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="201.5" y="623.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="235.5" y="644.3027">&#171;App&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="96" x="208.5" y="660.791">Certified App</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="604" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="658" y="75.9785">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="151" x="611" y="92.4668">Certified App Service</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="604" y="623.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="658" y="644.3027">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="151" x="611" y="660.791">Certified App Service</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="779" y="55.4434"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="786" y="75.9785">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="20" x="804.5" y="92.4668">TA</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="779" y="623.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="786" y="644.3027">&#171;Server&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="20" x="804.5" y="660.791">TA</text><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="34.5" y="134.7305"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="681.5" y="193.3516"/><rect fill="#FFFFFF" height="198.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="809.5" y="294.2832"/><polygon fill="#181818" points="55.5,130.7305,45.5,134.7305,55.5,138.7305,51.5,134.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="49.5" x2="255.5" y1="134.7305" y2="134.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="61.5" y="129.9883">(1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="84.5" y="129.9883">Request SignedWalletInfo</text><polygon fill="#181818" points="244.5,160.041,254.5,164.041,244.5,168.041,248.5,164.041" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="39.5" x2="250.5" y1="164.041" y2="164.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="46.5" y="159.2988">(2)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="69.5" y="159.2988">Transmit SignedWalletInfo</text><polygon fill="#181818" points="669.5,189.3516,679.5,193.3516,669.5,197.3516,673.5,193.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256.5" x2="675.5" y1="193.3516" y2="193.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="263.5" y="188.6094">(3)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="286.5" y="188.6094">Request AttestedAppInfo</text><polygon fill="#181818" points="267.5,218.6621,257.5,222.6621,267.5,226.6621,263.5,222.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261.5" x2="685.5" y1="222.6621" y2="222.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="273.5" y="217.9199">(4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="296.5" y="217.9199">Transmit AttestedAppInfo</text><line style="stroke:#181818;stroke-width:1.0;" x1="256.5" x2="298.5" y1="251.9727" y2="251.9727"/><line style="stroke:#181818;stroke-width:1.0;" x1="298.5" x2="298.5" y1="251.9727" y2="264.9727"/><line style="stroke:#181818;stroke-width:1.0;" x1="257.5" x2="298.5" y1="264.9727" y2="264.9727"/><polygon fill="#181818" points="267.5,260.9727,257.5,264.9727,267.5,268.9727,263.5,264.9727" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="263.5" y="247.2305">(5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="286.5" y="247.2305">Generate ServerTokenSeed (SignedWalletInfo, AttestedAppInfo)</text><polygon fill="#181818" points="797.5,290.2832,807.5,294.2832,797.5,298.2832,801.5,294.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256.5" x2="803.5" y1="294.2832" y2="294.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="263.5" y="289.541">(6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="321" x="286.5" y="289.541">Request ServerToken Generation (ServerTokenSeed)</text><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="861.5" y1="323.5938" y2="323.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="861.5" x2="861.5" y1="323.5938" y2="336.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="820.5" x2="861.5" y1="336.5938" y2="336.5938"/><polygon fill="#181818" points="830.5,332.5938,820.5,336.5938,830.5,340.5938,826.5,336.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="826.5" y="318.8516">(7)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283" x="849.5" y="318.8516">Generate ServerTokenData (ServerTokenSeed)</text><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="861.5" y1="365.9043" y2="365.9043"/><line style="stroke:#181818;stroke-width:1.0;" x1="861.5" x2="861.5" y1="365.9043" y2="378.9043"/><line style="stroke:#181818;stroke-width:1.0;" x1="820.5" x2="861.5" y1="378.9043" y2="378.9043"/><polygon fill="#181818" points="830.5,374.9043,820.5,378.9043,830.5,382.9043,826.5,378.9043" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="826.5" y="361.1621">(8)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="849.5" y="361.1621">Generate ServerToken (ServerTokenData)</text><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="861.5" y1="408.2148" y2="408.2148"/><line style="stroke:#181818;stroke-width:1.0;" x1="861.5" x2="861.5" y1="408.2148" y2="421.2148"/><line style="stroke:#181818;stroke-width:1.0;" x1="820.5" x2="861.5" y1="421.2148" y2="421.2148"/><polygon fill="#181818" points="830.5,417.2148,820.5,421.2148,830.5,425.2148,826.5,421.2148" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="826.5" y="403.4727">(9)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="849.5" y="403.4727">Generate IV</text><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="861.5" y1="450.5254" y2="450.5254"/><line style="stroke:#181818;stroke-width:1.0;" x1="861.5" x2="861.5" y1="450.5254" y2="463.5254"/><line style="stroke:#181818;stroke-width:1.0;" x1="820.5" x2="861.5" y1="463.5254" y2="463.5254"/><polygon fill="#181818" points="830.5,459.5254,820.5,463.5254,830.5,467.5254,826.5,463.5254" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="826.5" y="445.7832">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="858.5" y="445.7832">Encrypt ServerTokenData (SessionKey, IV)</text><path d="M207,437.7148 L207,462.7148 L804,462.7148 L804,447.7148 L794,437.7148 L207,437.7148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M794,437.7148 L794,447.7148 L804,447.7148 L794,437.7148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="576" x="213" y="455.2832">The TA and the CApp have already exchanged session keys before issuing the server token.</text><polygon fill="#181818" points="267.5,488.8359,257.5,492.8359,267.5,496.8359,263.5,492.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261.5" x2="813.5" y1="492.8359" y2="492.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="273.5" y="488.0938">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="305.5" y="488.0938">Transmit Encrypted ServerTokenData (IV)</text><line style="stroke:#181818;stroke-width:1.0;" x1="256.5" x2="298.5" y1="522.1465" y2="522.1465"/><line style="stroke:#181818;stroke-width:1.0;" x1="298.5" x2="298.5" y1="522.1465" y2="535.1465"/><line style="stroke:#181818;stroke-width:1.0;" x1="257.5" x2="298.5" y1="535.1465" y2="535.1465"/><polygon fill="#181818" points="267.5,531.1465,257.5,535.1465,267.5,539.1465,263.5,535.1465" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="263.5" y="517.4043">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="295.5" y="517.4043">Decrypt ServerTokenData</text><line style="stroke:#181818;stroke-width:1.0;" x1="256.5" x2="298.5" y1="564.457" y2="564.457"/><line style="stroke:#181818;stroke-width:1.0;" x1="298.5" x2="298.5" y1="564.457" y2="577.457"/><line style="stroke:#181818;stroke-width:1.0;" x1="257.5" x2="298.5" y1="577.457" y2="577.457"/><polygon fill="#181818" points="267.5,573.457,257.5,577.457,267.5,581.457,263.5,577.457" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="263.5" y="559.7148">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="295.5" y="559.7148">Generate ServerToken (ServerTokenData)</text><polygon fill="#181818" points="802.5,602.7676,812.5,606.7676,802.5,610.7676,806.5,606.7676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256.5" x2="808.5" y1="606.7676" y2="606.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="263.5" y="602.0254">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285" x="295.5" y="602.0254">When accessing TAS, submit the ServerToken</text><!--SRC=[bPDFJuD04CNFxgUOr4jRMvkOU6a82Qd6DDuiqVEmJDkDk20xLEkdTxPW_q6Yde3Tzzx-PcPXmncfYy2PBvhUt8OBAZTKGfo_aeLPISWcjy74RuUAR0gyCwW2IpRQ56WPUiFX2sOPyN3O0tJmWHa4GRqKXkVI6Sddqb0AKL4q3erYaCzVrE3fZAQzgn1RJTnsnb4ZOpnMOSMvhTuIAR8N967_SX1Cah2db32CGyz-TJM59tglo34ipCfIMfSojyiSb2zkB4ADu_4KuXAjUpDjOHCdYCTn4RCyA9LQ6b7H5TQMrLbJU21B9J91NSzkJ0kIxlJF0KRdAOCcXl6am4FEJxWCNE9EymUA6tCtmntA_dzD9mQVq6cOFn-jtbjTRWlkEjev0N-axKWS0sLpiMQqP6dhcY2E0FtbbTUPlqXht11W9lSxtG9zwZNQbNJHrIdmIbi72Itpai0uLncxsdbT_NUmF_TwXzKUNeCeQIr83tQOvHrrrh9Nm9-xflVzULcB0BNsTGXp72r6uAh4Std-8wVw1W00]--></g></svg>